I"\<p>Táº¡i há»™i nghá»‹ WWDC 2017 Ä‘ang diá»…n ra, Apple Ä‘Ã£ ra máº¯t má»™t bá»™ kit má»›i, há»— trá»£ cho viá»‡c tÃ­ch há»£p há»c mÃ¡y (Machine Learning â€“ ML), Ä‘Ã³ chÃ­nh lÃ  CoreML. Báº£n thÃ¢n mÃ¬nh cÅ©ng Ä‘ang chÃ¢n Æ°á»›t chÃ¢n rÃ¡o vÃ o ML Ä‘Æ°á»£c má»™t thá»i gian ngáº¯n, nÃªn mÃ¬nh quyáº¿t Ä‘á»‹nh viáº¿t blog nÃ y nháº±m má»¥c Ä‘Ã­ch chia sáº» vÃ  giá»›i thiá»‡u nhá»¯ng gÃ¬ mÃ¬nh biáº¿t, mÃ¬nh hiá»ƒu, vÃ  hi vá»ng sáº½ cung cáº¥p Ä‘Æ°á»£c cho cÃ¡c báº¡n cÃ¡i nhÃ¬n sÆ¡ khai nháº¥t vá» ML vÃ  CoreML trong iOS.</p>

<p>TrÆ°á»›c khi Ä‘i vÃ o váº¥n Ä‘á» chÃ­nh, mÃ¬nh sáº½ chia sáº» qua má»™t chÃºt kiáº¿n thá»©c á»Ÿ dáº¡ng vá»¡ lÃ²ng nháº¥t cá»§a ML, nháº±m táº¡o mindset cho cÃ¡c báº¡n vá» váº¥n Ä‘á» mÃ  chÃºng ta sáº½ tÃ¬m hiá»ƒu trong bÃ i viáº¿t nÃ y. ML tháº­t sá»± lÃ  má»™t lÄ©nh vá»±c ráº¥t lá»›n, Ä‘á»ƒ nÃ³i vá» nÃ³ thÃ¬ khÃ´ng thá»ƒ chá»‰ vá»n váº¹n trong má»™t vÃ i bÃ i viáº¿t Ä‘Æ°á»£c, hÆ¡n ná»¯a, ngÆ°á»i viáº¿t cÅ©ng thá»«a nháº­n báº£n thÃ¢n khÃ´ng Ä‘á»§ kiáº¿n thá»©c Ä‘á»ƒ chia sáº» toÃ n bá»™ ML cho cÃ¡c báº¡n. Dá»±a trÃªn tinh tháº§n chia sáº» vÃ  há»c táº­p, náº¿u cÃ¡c báº¡n cÃ³ tháº¯c máº¯c hay cÃ¢u há»i gÃ¬, hÃ£y Ä‘á»ƒ láº¡i comment vÃ  mÃ¬nh sáº½ há»“i Ä‘Ã¡p.</p>

<!--more-->

<h1 style="text-align:center;">
  <strong>Pháº§n I: ML trong táº§m tay.</strong>
</h1>

<ol>
  <li><em><strong>NghÄ© khÃ¡c Ä‘i:</strong></em></li>
</ol>

<p>VÃ­ dá»¥ thá»±c tiá»…n vá» AI vÃ  ML hiá»‡n táº¡i khÃ´ng thiáº¿u, cÃ¡c há»‡ thá»‘ng nháº­n dáº¡ng khuÃ´n máº·t, váº­t thá»ƒ, giá»ng nÃ³i,â€¦ hay cÃ¡c há»‡ thá»‘ng tá»± Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh nhÆ° xe tá»± hÃ nh, Alpha Go,â€¦ ML xuáº¥t hiá»‡n kháº¯p má»i vá»›i tá»‘c Ä‘á»™ chÃ³ng máº·t vÃ  Ä‘á»™ chuáº©n xÃ¡c cá»±c ká»³ cao. ChÃºng ta háº³n sáº½ tá»± há»i, Ä‘iá»u gÃ¬ Ä‘Ã£ Ä‘em Ä‘áº¿n sá»©c máº¡nh cho ML, vÃ  nÃ³ cÃ³ gÃ¬ khÃ¡c so vá»›i nhá»¯ng gÃ¬ chÃºng ta tá»«ng biáº¿t hay khÃ´ng?</p>

<p>Ta láº¥y vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá»›i há»‡ thá»‘ng nháº­n dáº¡ng váº­t thá»ƒ thÃ´ng qua áº£nh, báº¡n Ä‘Æ°a vÃ o má»™t bá»©c áº£nh, cháº³ng háº¡n lÃ  con mÃ¨o, báº¡n muá»‘n nÃ³ tráº£ cho báº¡n káº¿t quáº£ â€œÄ‘Ã³ lÃ  áº£nh cá»§a con mÃ¨oâ€, theo báº¡n, nÃ³ sáº½ lÃ m tháº¿ nÃ o ?</p>

<p>ÄÃ¢y lÃ  bÃ i toÃ¡n filter thÃ´ng thÆ°á»ng trong láº­p trÃ¬nh, viá»‡c cá»§a chÃºng chá»‰ lÃ  for loop Ä‘á»ƒ duyá»‡t, rá»“i tÃ¬m ra bá»©c áº£nh giá»‘ng hoáº·c gáº§n giá»‘ng nháº¥t vá»›i cÃ¡i áº£nh ta nhÃ©t vÃ o, rá»“i xÃ i máº¥y thuáº­t toÃ¡n tá»‘i Æ°u nhÆ° lÃ  sáº¯p xáº¿p trÆ°á»›c (sort) filter sau hoáº·c xÃ i multithreading Ä‘á»ƒ duyá»‡t cho nhanh, so easy. Tháº¿ nhÆ°ng báº¡n Æ¡i, náº¿u dá»¯ liá»‡u cá»§a báº¡n lÃªn Ä‘áº¿n hÃ ng trÄƒm nghÃ¬n, rá»“i hÃ ng triá»‡u tháº­m chÃ­ hÃ ng trÄƒm triá»‡u thÃ¬ sao? ÄÃ³ má»›i chá»‰ lÃ  1 Ä‘áº§u vÃ o, Ä‘áº¿n khi há» muá»‘n nhÃ©t thÃªm nhiá»u Ä‘áº§u vÃ o (á»Ÿ vÃ­ dá»¥ nÃ y lÃ  nhÃ©t thÃªm áº£nh mÃ¨o, áº£nh gáº¥u) thÃ¬ sao??</p>

<p>Há»“i chÆ°a biáº¿t, mÃ¬nh cÅ©ng tá»«ng nghÄ© nhÆ° tháº¿, vÃ  mÃ¬nh cÅ©ng bÄƒn khoÄƒn lÃ  náº¿u nhÆ° váº­y thÃ¬ lÃ m sao mÃ  AI nÃ³ Ä‘Æ°a káº¿t quáº£ nhanh Ä‘Æ°á»£c nhÆ° váº­y. KhÃ´ng, suy nghÄ© Ä‘Ã³ lÃ  SAI HOÃ€N TOÃ€N, hÃ£y bá» nÃ³ Ä‘i, clear your mind.</p>

<p>CÃ¹ng nghÄ© vá» cá»¥m tá»« â€œHá»c MÃ¡yâ€ (Machine Learning) â€“ nghÄ©a lÃ  ta cho cÃ¡i mÃ¡y nÃ³ há»c. Váº­y cÃ¡i mÃ¡y thÃ¬ nÃ³ há»c gÃ¬? ÄÃºng, chÃ­nh lÃ  há»c cÃ¡c dá»¯ liá»‡u mÃ  báº¡n cung cáº¥p. NhÆ°ng cÃ¡i chÃºng ta Ä‘ang khÃºc máº¯c á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  Ä‘á»™ng tá»« â€œHá»ŒCâ€, vá»›i má»™t cÃ¡i mÃ¡y tÃ­nh, há»c á»Ÿ Ä‘Ã¢y lÃ  lÃ m gÃ¬? NhÃ¬n láº¡i váº¥n Ä‘á», bÃ i toÃ¡n thá»±c sá»± cá»§a chÃºng ta lÃ  chuyá»ƒn má»™t táº­p áº£nh váº­t thá»ƒ xÃ¡c Ä‘á»‹nh, sang má»™t táº­p cÃ¡c káº¿t quáº£ phÃ¡n quyáº¿t (con mÃ¨o, con gÃ , con gáº¥u, â€¦ ). ÄÃ¢y chÃ­nh lÃ  bÃ i toÃ¡n Ã¡nh xáº¡ trong toÃ¡n há»c:<figure id="attachment_1037" style="width: 330px" class="wp-caption aligncenter"></figure></p>

<p><img class=" size-full wp-image-1037 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/330px-codomain2-svg.png" alt="330px-codomain2-svg" width="330" height="248" srcset="/wp-content/uploads/2017/06/330px-codomain2-svg.png 330w, /wp-content/uploads/2017/06/330px-codomain2-svg-300x225.png 300w" sizes="(max-width: 330px) 100vw, 330px" /> &lt;figcaption class="wp-caption-text"&gt;(nguá»“n: wikipedia)&lt;/figcaption&gt;&lt;/figure&gt;</p>

<p>Ã¡nh xáº¡ lÃ  viá»‡c 1 Ä‘áº¡i lÆ°á»£ng trong táº­p X, cho ra 1 káº¿t quáº£ náº±m trong táº­p Y, dá»±a trÃªn cÃ´ng thá»©c tÃ­nh toÃ¡n cá»§a hÃ m f.Â Báº¡n cÃ³ tháº¥y nÃ³ quen quen khÃ´ng? ÄÃºng, nÃ³ chÃ­nh lÃ  ML mÃ  chÃºng ta Ä‘ang nÃ³i Ä‘áº¿n Ä‘áº¥y.Â á» Ä‘Ã¢y X lÃ  táº­p cÃ¡c áº£nh váº­t thá»ƒ, cÃ²n Y lÃ  cÃ¡c nhÃ£n phÃ¢n loáº¡i con váº­t (mÃ¨o, gÃ , chÃ³,..) mÃ  mÃ¬nh nÃ³i á»Ÿ trÃªn. Äáº§u vÃ o cá»§a chÃºng ta lÃ  má»™t bá»©c áº£nh (tá»©c lÃ  náº±m trong táº­p â€œáº£nhâ€ â€“ X), vÃ  Ä‘áº§u ra lÃ  káº¿t quáº£ phÃ¡n Ä‘á»‹nh áº£nh nÃ y lÃ  áº£nh con mÃ¨o (táº­p Y) . Váº­y ML lÃ m gÃ¬? Thá»±c ra viá»‡c cá»§a ML lÃ  tÃ¬m ra má»‘i liÃªn há»‡ Ã¡nh xáº¡ giá»¯a X vÃ  Y, hay nÃ³i cÃ¡ch khÃ¡c, viá»‡c â€œhá»câ€ á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  tÃ¬m ra hÃ m f, dá»±a trÃªn X vÃ  Y.</p>

<p>Váº­y, viá»‡c tÃ¬m ra hÃ m f cÃ³ Ã½ nghÄ©a gÃ¬?</p>

<p><strong><em>2. Sá»± khÃ¡c biá»‡t:</em></strong></p>

<p>NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, hÃ m f chÃ­nh lÃ  cÃ´ng thá»©c, lÃ  chÃ¬a khÃ³a Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ Ã¡nh xáº¡ qua láº¡i giá»¯a Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra. KhÃ¡c vá»›i cÃ¡ch giáº£i báº±ng phÆ°Æ¡ng phÃ¡p lá»c (filter) ban Ä‘áº§u, giá» Ä‘Ã¢y má»—i khi chÃºng ta cÃ³ Ä‘áº§u vÃ o (má»™t bá»©c áº£nh), Ä‘Æ°a nÃ³ qua hÃ m f Ä‘á»ƒ tÃ­nh, vÃ  nháº­n káº¿t quáº£ Ä‘áº§u ra. Viá»‡c tÃ­nh toÃ¡n nÃ y ráº¥t nhanh, vÃ¬ lÃºc nÃ y chÃºng ta chá»‰ Ã¡p dá»¥ng cÃ´ng thá»©c toÃ¡n há»c, so vá»›i viá»‡c pháº£i dÃ² trong táº­p dá»¯ liá»‡u ban Ä‘áº§u.</p>

<p>Tuy nhiÃªn, viá»‡c tÃ¬m ra hÃ m f nÃ y cá»±c ká»³ phá»©c táº¡p, trÃªn thá»±c táº¿, chÃºng ta khÃ´ng tÃ¬m hÃ m f, mÃ  thay vÃ o Ä‘Ã³ chÃºng ta cá»‘ gáº¯ng tÃ¬m má»™t hÃ m h nÃ o Ä‘Ã³, sao cho nÃ³ gáº§n giá»‘ng vá»›i hÃ m f nháº¥t cÃ³ thá»ƒ, cÃ¡i gáº§n giá»‘ng á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  viá»‡c cho ra káº¿t quáº£ dá»±a trÃªn Ä‘áº§u vÃ o, pháº£i gáº§n nhau:<figure id="attachment_1073" style="width: 349px" class="wp-caption aligncenter"></figure></p>

<p><img class="  wp-image-1073 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2016-07-23-at-7-05-47-am.png" alt="screen-shot-2016-07-23-at-7-05-47-am" width="349" height="137" srcset="/wp-content/uploads/2017/06/screen-shot-2016-07-23-at-7-05-47-am.png 1221w, /wp-content/uploads/2017/06/screen-shot-2016-07-23-at-7-05-47-am-300x118.png 300w, /wp-content/uploads/2017/06/screen-shot-2016-07-23-at-7-05-47-am-768x301.png 768w, /wp-content/uploads/2017/06/screen-shot-2016-07-23-at-7-05-47-am-1024x402.png 1024w" sizes="(max-width: 349px) 100vw, 349px" /> &lt;figcaption class="wp-caption-text"&gt;(nguá»“n: septeni-technology)&lt;/figcaption&gt;&lt;/figure&gt;</p>

<p>Viá»‡c há»c mÃ¡y cá»§a chÃºng ta cuá»‘i cÃ¹ng cÃ³ thá»ƒ quy vá» viá»‡c tÃ¬m cho ra hÃ m h, bÆ°á»›c suy Ä‘oÃ¡n tÃ¬m ra hÃ m nÃ y dá»±a trÃªn dá»¯ liá»‡u Ä‘áº§u vÃ o, Ä‘Æ°á»£c gá»i lÃ  bÆ°á»›c huáº¥n luyá»‡n dá»¯ liá»‡u (training data), vÃ  hÃ m h thu Ä‘Æ°á»£c, chÃ­nh lÃ  mÃ´ hÃ¬nh dá»¯ liá»‡u (model). CÆ¡ sá»Ÿ suy luáº­n Ä‘á»ƒ tÃ¬m ra hÃ m h nÃ y cáº§n nhiá»u kiáº¿n thá»©c vá» toÃ¡n há»c cao cáº¥p: giáº£i tÃ­ch, Ä‘áº¡i sá»‘ tuyáº¿n tÃ­nh, xÃ¡c suáº¥t thá»‘ng kÃª,â€¦ Chi tiáº¿t cá»¥ thá»ƒ mÃ¬nh sáº½ khÃ´ng trÃ¬nh bÃ y láº§n nÃ y, vÃ¬ nÃ³ ráº¥t rá»™ng vÃ  trong bÃ i viáº¿t nÃ y, cÃ¡c báº¡n cÅ©ng khÃ´ng cáº§n dÃ¹ng Ä‘áº¿n má»©c sÃ¢u nhÆ° váº­y. Quay trá»Ÿ láº¡i vá»›i hÃ m h, vÃ¬ Ä‘Ã¢y lÃ  hÃ m suy diá»…n gáº§n Ä‘Ãºng, cho nÃªn so vá»›i hÃ m mong muá»‘n (lÃ  hÃ m f) sáº½ cÃ³ sai sá»‘ nháº¥t Ä‘á»‹nh, do Ä‘Ã³ sinh ra khÃ¡i niá»‡m confidence (Ä‘á»™ tin tÆ°á»Ÿng) nháº±m chá»‰ xÃ¡c suáº¥t tiÃªn Ä‘oÃ¡n nÃ³ lÃ  káº¿t quáº£ Ä‘Ãºng lÃ  bao nhiÃªu. NgoÃ i ra, ML cÃ²n bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi dá»¯ liá»‡u Ä‘áº§u vÃ o, hiá»ƒn nhiÃªn náº¿u ta cho Ã­t dá»¯ liá»‡u, thÃ¬ viá»‡c suy Ä‘oÃ¡n sáº½ khÃ³, hoáº·c suy Ä‘oÃ¡n hÃ m h khÃ´ng chuáº©n. BÃªn cáº¡nh Ä‘Ã³, trÆ°á»›c khi Ä‘Æ°a vÃ o suy Ä‘oÃ¡n, ML cÃ²n pháº£i tÃ¡ch Ä‘áº§u vÃ o thÃ nh cÃ¡c Ä‘áº·c trÆ°ng khÃ¡c nhau (feature) Ä‘á»ƒ giáº£m thiá»ƒu khá»‘i lÆ°á»£ng tÃ­nh toÃ¡n vÃ  tÄƒng cÆ°á»ng Ä‘á»™ chÃ­nh xÃ¡c cho káº¿t quáº£ ( vÃ­ dá»¥ nhÆ° tÃ¡ch Ä‘áº·c trÆ°ng cá»§a con mÃ¨o so vá»›i con chÃ³, con gÃ ,â€¦).</p>

<p><span style="color:#ff0000;"><strong>â€“&gt; Tá»•ng káº¿t: Báº¡n cáº§n nhá»› gÃ¬ qua pháº§n nÃ y ?</strong></span></p>

<ul>
  <li>CÃ´ng viá»‡c cá»§a ML lÃ  tÃ¬m kiáº¿m hÃ m H gáº§n giá»‘ng vá»›i hÃ m Ã¡nh xáº¡ chuáº©n giá»¯a 2 táº­p Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra.</li>
  <li>Training data lÃ  bÆ°á»›c sá»­ dá»¥ng dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘á»ƒ tÃ¬m hÃ m H.</li>
  <li>Model lÃ  hÃ m H thu Ä‘Æ°á»£c, vÃ  Ä‘Ã³ chÃ­nh lÃ  káº¿t quáº£ cá»§a há»c mÃ¡y.</li>
  <li>Confidence: xÃ¡c suáº¥t chÃ­nh xÃ¡c cá»§a káº¿t quáº£ phÃ¡n Ä‘á»‹nh bá»Ÿi model.</li>
</ul>

<p>Â </p>

<h1 style="text-align:center;">
  <strong>Pháº§n II: LÃ m quen vá»›i CoreML.</strong>
</h1>

<p>Huáº¥n luyá»‡n dá»¯ liá»‡u lÃ  má»™t cÃ´ng Ä‘oáº¡n khÃ´ng há» Ä‘Æ¡n giáº£n, vá»›i chi phÃ­ tÃ­nh toÃ¡n vÃ  thá»i gian lá»›n, Ä‘iá»u nÃ y phá»¥ thuá»™c vÃ o cÃ¡c bÆ°á»›c toÃ¡n há»c vÃ  sá»‘ lÆ°á»£ng cÅ©ng nhÆ° Ä‘á»™ phá»©c táº¡p cá»§a táº­p Ä‘áº§u vÃ o. MÃ¬nh Ä‘Ã£ thá»­ tá»± tay training 1 táº­p 20.000 bá»©c áº£nh (dáº¡ng bit) vÃ  cÃ´ng Ä‘oáº¡n nÃ y ngá»‘n ~ 30 phÃºt. Tuy ráº±ng hiá»‡n nay má»™t sá»‘ framework há»— trá»£ viá»‡c training data ngay trÃªn mobile, tiÃªu biá»ƒu nháº¥t lÃ  TensorFlow (viáº¿t báº±ng Objective-C++ vÃ  C), nhÆ°ng cÅ©ng chá»‰ giáº£i quyáº¿t má»™t sá»‘ bÃ i toÃ n nhá».</p>

<p>â€“&gt; Training data trÃªn mobile lÃ  viá»‡c lÃ m khÃ´ng khuyáº¿n khÃ­ch vÃ  khÃ´ng Ä‘em láº¡i nhiá»u Ã½ nghÄ©a. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ sáºµn lÃ²ng bá» ra 1 khoáº£ng thá»i gian khÃ´ng nhá» chá»‰ Ä‘á»ƒ Ä‘á»£i cÃ¡i á»©ng dá»¥ng cá»§a chÃºng ta training data khÃ´ng?</p>

<p>Trá»Ÿ vá» vá»›i cÃ´ng viá»‡c chÃ­nh cá»§a chÃºng ta â€“ nhá»¯ng ngÆ°á»i láº­p trÃ¬nh viÃªn iOS, váº­y chÃºng ta ká»³ vá»ng Ä‘iá»u gÃ¬ á»Ÿ ML ? ÄÃºng, chÃºng ta khÃ´ng huáº¥n luyá»‡n dá»¯ liá»‡u, thay vÃ o Ä‘Ã³ chÃºng ta á»©ng dá»¥ng káº¿t quáº£ cá»§a chÃºng, chÃ­nh lÃ  Model (hay hÃ m H á»Ÿ trÃªn). VÃ  táº¡i WWDC2017, Apple Ä‘Ã£ giÃºp chÃºng ta Ä‘iá»u nÃ y báº±ng viá»‡c cung cáº¥p CoreML.</p>

<ol>
  <li><em><strong>CoreML lÃ  gÃ¬ (What is CoreML):</strong></em></li>
</ol>

<p>TrÃªn <a href="https://developer.apple.com/documentation/coreml">trang chá»§</a> cá»§a mÃ¬nh, Apple chá»‰ viáº¿t ngáº¯n gá»n tháº¿ nÃ y:</p>

<blockquote>
  <p><em>Integrate machine learning models into your app.</em></p>
</blockquote>

<p>CoreML giÃºp tÃ­ch há»£p model vÃ o trong á»©ng dá»¥ng cá»§a báº¡n. TÃ­ch há»£p nhÆ° tháº¿ nÃ o ? Há»“i sau sáº½ rÃµ.</p>

<p>CoreML cÃ²n há»— trá»£ má»™t sá»‘ native framework khÃ¡c cá»§a Apple, nhÆ° lÃ  Vision (cho viá»‡c phÃ¢n tÃ­ch áº£nh), Foundation (cho viá»‡c xá»­ lÃ½ nháº­n dáº¡ng Ã¢m thanh vÃ  ngá»¯ nghÄ©a),â€¦</p>

<p><em><strong>2. Sá»­ dá»¥ng CoreML nhÆ° tháº¿ nÃ o: (how to use it)</strong></em></p>

<p>VÃ¬ báº£n cháº¥t cá»§a CoreML lÃ  tÃ­ch há»£p model Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n vÃ o trong á»©ng dá»¥ng</p>

<p><em><span style="color:#3366ff;">â€“&gt; BÆ°á»›c Ä‘áº§u tiÃªn: pháº£i cÃ³ Model. Váº­y model nÃ y láº¥y á»Ÿ Ä‘Ã¢u?</span></em></p>

<p>CoreML hiá»‡n táº¡i chá»‰ nháº­n Ä‘Ãºng má»™t Ä‘á»‹nh dáº¡ng lÃ  .mlmodel, do Ä‘Ã³, náº¿u chÃºng ta muá»‘n sá»­ dá»¥ng model bÃªn ngoÃ i, chÃºng ta cáº§n pháº£i convert nÃ³ sang Ä‘á»‹nh dáº¡ng nÃ y. Apple cÃ³ há»— trá»£ Â sáºµn <a href="https://pypi.python.org/pypi/coremltools">CoreMLTools</a> Ä‘á»ƒ lÃ m viá»‡c nÃ y. Trong pháº¡m vi vÃ  má»¥c tiÃªu cá»§a má»™t bÃ i lÃ m quen, chÃºng ta sáº½ khÃ´ng cáº§n thao tÃ¡c phá»©c táº¡p Ä‘áº¿n váº­y, chÃºng ta chá»‰ cáº§n sá»­ dá»¥ng nhá»¯ng mlmodel cÃ³ sáºµn, do Apple chÃ­nh Apple Ä‘Æ°a ra, cÃ¡c báº¡n cÃ³ thá»ƒ táº£i chÃºng vá» <a href="https://developer.apple.com/machine-learning/">táº¡i Ä‘Ã¢y.</a></p>

<p><img class="aligncenter size-full wp-image-1171" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-10-16-58-am.png?w=637" alt="Screen Shot 2017-06-12 at 10.16.58 AM.png" width="637" height="426" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-16-58-am.png 1059w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-16-58-am-300x201.png 300w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-16-58-am-768x514.png 768w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-16-58-am-1024x686.png 1024w" sizes="(max-width: 637px) 100vw, 637px" /></p>

<p>á» Ä‘Ã¢y mÃ¬nh dÃ¹ng model tÃªn lÃ  VGG16.</p>

<p><em><span style="color:#3366ff;">â€“&gt; BÆ°á»›c thá»© 2: TÃ­ch há»£p model vÃ o trong project vÃ  xcode.</span></em></p>

<p>Äáº§u tiÃªn, cÃ¡c báº¡n kÃ©o tháº£ file vá»«a download vÃ o trong thÆ° má»¥c:</p>

<p><img class="alignnone size-full wp-image-1176" src="https://devislifeblog.files.wordpress.com/2017/06/1.gif" alt="1.gif" width="836" height="512" /></p>

<p>Tiáº¿p Ä‘áº¿n: cÃ¡c báº¡n kÃ©o tháº£ nÃ³ vÃ o trong project táº¡i xcode vÃ  lá»±a chá»n target cho nÃ³ lÃ  project cá»§a báº¡n. LÆ°u Ã½ bÆ°á»›c nÃ y ráº¥t quan trá»ng, vÃ¬ náº¿u báº¡n khÃ´ng lá»±a chá»n target cho nÃ³, thÃ¬ Ä‘á»“ng nghÄ©a nÃ³ khÃ´ng Ä‘Æ°á»£c add vÃ o project vÃ  bundle lÃºc Ä‘Ã³ng gÃ³i cá»§a project, vÃ¬ váº­y báº¡n khÃ´ng thá»ƒ dÃ¹ng Ä‘Æ°á»£c nÃ³.</p>

<p><img class="  wp-image-1183 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/2.gif" alt="2" width="249" height="459" /></p>

<p><img class="  wp-image-1184 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/3.gif" alt="3" width="230" height="423" /></p>

<p>Giá» thÃ¬ hÃ£y chá»n file VGG16.mlmodel cá»§a cÃ¡c báº¡n trÃªn XCode, vÃ  cÃ¹ng tÃ¬m hiá»ƒu:</p>

<p><img class="alignnone size-full wp-image-1194" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-10-38-15-am1.png" alt="Screen Shot 2017-06-12 at 10.38.15 AM.png" width="738" height="484" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-38-15-am1.png 738w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-10-38-15-am1-300x197.png 300w" sizes="(max-width: 738px) 100vw, 738px" /></p>

<ul>
  <li>Má»¥c 1 lÃ  thÃ´ng tin vá» mlmodel, khÃ´ng cÃ³ gÃ¬ quan trá»ng.</li>
  <li>Má»¥c 2 lÃ  Model Class. Khi cÃ¡c báº¡n import file mlmodel vÃ o Xcode, Xcode sáº½ tá»± Ä‘á»™ng sinh ra cho báº¡n cÃ¡i Model Class nÃ y, Ä‘Ã¢y chÃ­nh sá»©c máº¡nh then chá»‘t cá»§a CoreML â€“ tá»« model, báº¡n cÃ³ class.</li>
  <li>Má»¥c 3 lÃ  detail input vÃ  output, nhÆ° trong hÃ¬nh: model cá»§a chÃºng ta nháº­n Ä‘áº§u vÃ o lÃ  1 áº£nh cÃ³ dáº¡ng Image,&lt;BGR,224,224&gt;, vÃ  output gá»“m 2 giÃ¡ trá»‹ lÃ  classLabelProbs vÃ  classLabel.</li>
</ul>

<p>DÆ°á»›i Ä‘Ã¢y lÃ  class mÃ  Xcode sinh sáºµn tá»« model cho chÃºng ta:</p>

<p><img class="alignnone size-full wp-image-1232" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-1-42-00-pm.png" alt="Screen Shot 2017-06-12 at 1.42.00 PM.png" width="717" height="679" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-42-00-pm.png 717w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-42-00-pm-300x284.png 300w" sizes="(max-width: 717px) 100vw, 717px" /></p>

<p><img class="alignnone size-full wp-image-1233" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-1-42-29-pm.png" alt="Screen Shot 2017-06-12 at 1.42.29 PM.png" width="633" height="483" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-42-29-pm.png 633w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-42-29-pm-300x229.png 300w" sizes="(max-width: 633px) 100vw, 633px" /></p>

<p><em><strong>3. VÃ­ dá»¥ vá» sá»­ dá»¥ng CoreML:</strong></em></p>

<p>Ã tÆ°á»Ÿng bÃ i toÃ¡n: chá»n áº£nh trong Gallery â€“&gt; dÃ¹ng CoreML Ä‘á»ƒ tiÃªn Ä‘oÃ¡n xem áº£nh Ä‘Ã³ mÃ´ táº£ cÃ¡i gÃ¬?.</p>

<p><span style="color:#3366ff;"><em>a) Thiáº¿t káº¿ UI:</em></span></p>

<p><img class=" size-full wp-image-1205 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-1-16-56-pm.png" alt="Screen Shot 2017-06-12 at 1.16.56 PM.png" width="324" height="560" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-16-56-pm.png 324w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-16-56-pm-174x300.png 174w" sizes="(max-width: 324px) 100vw, 324px" /></p>

<p>MÃ¬nh cÃ³ 1 cÃ¡i áº£nh, Ä‘á»ƒ thá»ƒ hiá»‡n áº£nh mÃ¬nh chá»n, 1 cÃ¡i label Ä‘á»ƒ thá»ƒ hiá»‡n káº¿t quáº£ cÃ³ Ä‘Æ°á»£c khi kiá»ƒm tra vá»›i ML, 1 nÃºt â€œAddâ€ Ä‘á»ƒ show mÃ n hÃ¬nh chá»n áº£nh trong bá»™ sÆ°u táº­p cá»§a mÃ¡y. Äá»‘i vá»›i cÃ¡c báº¡n test trÃªn simulator, cÃ¡c báº¡n nÃªn kÃ©o thÃªm áº£nh bÃªn ngoÃ i vÃ o trong, thay vÃ¬ 4 áº£nh máº·c Ä‘á»‹nh.</p>

<p><img class="aligncenter size-full wp-image-1213" src="https://devislifeblog.files.wordpress.com/2017/06/4.gif" alt="4.gif" width="502" height="320" /></p>

<p><span style="color:#3366ff;"><em>b) NÃ o mÃ¬nh cÃ¹ng code:</em></span></p>

<p>Äáº§u tiÃªn cÃ¡c báº¡n cáº§n thá»±c hiá»‡n pháº§n viá»‡c click vÃ o button Ä‘á»ƒ show lÃªn mÃ n hÃ¬nh chá»n áº£nh:</p>

<p><img class="aligncenter size-full wp-image-1217" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-1-23-54-pm.png" alt="Screen Shot 2017-06-12 at 1.23.54 PM.png" width="512" height="251" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-23-54-pm.png 512w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-1-23-54-pm-300x147.png 300w" sizes="(max-width: 512px) 100vw, 512px" /></p>

<p>ChÃº Ã½, vÃ¬ model cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c Xcode chuyá»ƒn thÃ nh class, cho nÃªn chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ nhÆ° má»™t class bÃ¬nh thÆ°á»ng, vÃ­ dá»¥ táº¡o instance cho nÃ³, á»Ÿ Ä‘Ã¢y mÃ¬nh gÃ¡n cho nÃ³ vÃ o 1 biáº¿n:</p>

<p><img class=" size-full wp-image-1222 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-1-25-31-pm.png" alt="Screen Shot 2017-06-12 at 1.25.31 PM.png" width="250" height="50" /></p>

<p>NhÃ¬n láº¡i model cá»§a chÃºng ta, khi Ä‘Æ°á»£c convert theo XCode, Ä‘áº§u vÃ o lÃºc nÃ y nháº­n vÃ o 1 image cÃ³ dáº¡ng PixelBuffer â€“&gt; chÃºng ta cáº§n pháº£i convert áº£nh cÅ©ng chÃºng ta sang dáº¡ng nÃ y. MÃ¬nh táº¡o 1 class Utils Ä‘á»ƒ Ä‘áº£m nháº­n 2 viá»‡c resizeImage vÃ  convert nÃ³ sang PixelBuffer:</p>

<p><img class="aligncenter size-full wp-image-1251" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-2-15-40-pm.png" alt="Screen Shot 2017-06-12 at 2.15.40 PM.png" width="1105" height="881" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-15-40-pm.png 1105w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-15-40-pm-300x239.png 300w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-15-40-pm-768x612.png 768w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-15-40-pm-1024x816.png 1024w" sizes="(max-width: 1105px) 100vw, 1105px" /></p>

<p>Ok, chÃºng ta Ä‘Ã£ xong 90% cÃ´ng viá»‡c rá»“i, giá» quay láº¡i vá»›i ViewController, pháº§n viá»‡c cÃ²n láº¡i cá»§a chÃºng ta chá»‰ lÃ  sá»­ dá»¥ng model Ä‘á»ƒ tiÃªn Ä‘oÃ¡n áº£nh chÃºng ta chá»n:</p>

<p><img class="aligncenter size-full wp-image-1255" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-2-17-15-pm.png" alt="Screen Shot 2017-06-12 at 2.17.15 PM.png" width="864" height="313" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-17-15-pm.png 864w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-17-15-pm-300x109.png 300w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-17-15-pm-768x278.png 768w" sizes="(max-width: 864px) 100vw, 864px" /></p>

<p>LÆ°u Ã½ vÃ¬ Ä‘áº§u vÃ o cá»§a chÃºng ta lÃ  áº£nh &lt;BGR,224,224&gt; (224 á»Ÿ Ä‘Ã¢y lÃ  width vÃ  height cá»§a áº£nh) nÃªn chÃºng ta pháº£i resize vá» Ä‘Ãºng width height nÃ y. Äáº¿n Ä‘Ã¢y, chÃºng ta Ä‘Ã£ hoÃ n táº¥t má»i cÃ´ng Ä‘oáº¡n Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng 1 áº£nh trong gallery lÃ m Ä‘áº§u vÃ o cho model, trong code lÃ  biáº¿n imgAsPixelBuffer.</p>

<p><em><span style="color:#3366ff;">BÆ°á»›c cuá»‘i cÃ¹ng: CoreML sáº½ giÃºp chÃºng ta pháº§n viá»‡c tiÃªn Ä‘oÃ¡n cÃ²n láº¡i, chá»‰ Ä‘Æ¡n giáº£n báº±ng má»™t cÃ¢u lá»‡nh: model.prediction():</span></em></p>

<p><img class="aligncenter size-full wp-image-1264" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-2-21-14-pm.png" alt="Screen Shot 2017-06-12 at 2.21.14 PM.png" width="613" height="106" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-21-14-pm.png 613w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-21-14-pm-300x52.png 300w" sizes="(max-width: 613px) 100vw, 613px" /></p>

<p>ÄÃ¢y lÃ  toÃ n bá»™ source code cho ViewController:</p>

<p><img class=" size-full wp-image-1267 aligncenter" src="https://devislifeblog.files.wordpress.com/2017/06/screen-shot-2017-06-12-at-2-22-24-pm.png" alt="Screen Shot 2017-06-12 at 2.22.24 PM.png" width="878" height="932" srcset="/wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-22-24-pm.png 878w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-22-24-pm-283x300.png 283w, /wp-content/uploads/2017/06/screen-shot-2017-06-12-at-2-22-24-pm-768x815.png 768w" sizes="(max-width: 878px) 100vw, 878px" /></p>

<p>Â </p>

<p><strong><span style="color:#ff0000;">==&gt; Test káº¿t quáº£:</span></strong></p>

<p><img class="aligncenter size-full wp-image-1272" src="https://devislifeblog.files.wordpress.com/2017/06/5.gif" alt="5.gif" width="386" height="636" /></p>

<p>Â </p>

<ul>
  <li>NhÃ©t áº£nh con sÆ° tá»­ â€“&gt; ra lion, king of beasts,..</li>
  <li>NhÃ©t áº£nh con mÃ¨o â€“&gt; ra egytian cat (mÃ¨o ai cáº­p).</li>
  <li>NhÃ©t áº£nh con cÃºn â€“&gt; ra golden retriever (chÃº chÃ³ vÃ ng).</li>
</ul>

<p>Â </p>

<p>CÃ¡c báº¡n cÃ³ thá»ƒ download Source Code <a href="https://github.com/starptit/CoreMLExample/tree/master/CoreMLExample/CoreMLExample">táº¡i Ä‘Ã¢y</a>.</p>

<p>=============================================================</p>

<h1 style="text-align:center;">
  <strong>Tá»”NG Káº¾T</strong>
</h1>

<p>Qua blog nÃ y, cÃ¡c báº¡n cáº§n nhá»› Ä‘Æ°á»£c gÃ¬:</p>

<p>a. CÄƒn báº£n ML, nÃ³ lÃ  cÃ¡i gÃ¬: nÃ³ lÃ  quan há»‡ toÃ¡n há»c giá»¯a Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra, quÃ¡ trÃ¬nh há»c mÃ¡y lÃ  quÃ¡ trÃ¬nh tÃ¬m cho ra hÃ m liÃªn há»‡ nÃ y vá»›i xÃ¡c suáº¥t gáº§n Ä‘Ãºng tá»‘t nháº¥t.</p>

<p>b. CoreML lÃ  gÃ¬ vÃ  lÃ m gÃ¬? NÃ³ lÃ  má»™t framework Ä‘Æ°á»£c Apple giá»›i thiá»‡u nháº±m tÃ­ch há»£p model vÃ o trong á»©ng dá»¥ng cá»§a Apple.</p>

<p>c. DÃ¹ng nÃ³ tháº¿ nÃ o: Cáº§n má»™t model , import vÃ o Ä‘á»ƒ nÃ³ gen class vÃ  dÃ¹ng thÃ´i.</p>

<script id="dsq-count-scr" src="//https-vigorous-sinoussi-c377b6-netlify-com.disqus.com/count.js" async=""></script>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-vigorous-sinoussi-c377b6-netlify-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
:ET