I"²<p>Äá»£t vá»«a rá»“i tÃ´i cÃ³ hÆ¡i báº­n viáº¿t blog ná»™i bá»™ cho cÃ´ng ty nÃªn cÃ³ hÆ¡i bá» bÃª trang nÃ y, nhÆ°ng khÃ´ng sao, SwiftyVN Ä‘Ã£ trá»Ÿ láº¡i vÃ  Ä‘Æ°Æ¡ng nhiÃªn lÃ  series vá» Design Pattern cÅ©ng sáº½ quay láº¡iÂ ğŸ¤˜. Váº«n tiáº¿p ná»‘i chuá»—i bÃ i viáº¿t vá» loáº¡i Creational (khá»Ÿi táº¡o), vÃ  cÅ©ng váº«n lÃ  má»™t trong nhá»¯ng pattern thuá»™c hÃ ng phá»• thÃ´ng nháº¥t, Ä‘Ã³ chÃ­nh lÃ  <strong><span style="color: #993300;">Builder Design Pattern.</span></strong></p>

<p><img class="aligncenter wp-image-1878" src="/wp-content/uploads/2019/05/xfa1323749768.jpg" alt="" width="600" height="399" srcset="/wp-content/uploads/2019/05/xfa1323749768.jpg 800w, /wp-content/uploads/2019/05/xfa1323749768-300x200.jpg 300w, /wp-content/uploads/2019/05/xfa1323749768-768x511.jpg 768w" sizes="(max-width: 600px) 100vw, 600px" /></p>

<!--more-->

<h3 id="builder-design-pattern-lÃ -gÃ¬"><span style="color: #ff9900;">Builder Design Pattern lÃ  gÃ¬?</span></h3>

<p>Trong OOP, <span style="color: #993300;"><strong>Builder pattern</strong></span> thuá»™c loáº¡i <strong><span style="color: #993300;">creational</span></strong> (khá»Ÿi táº¡o), chÃ­nh vÃ¬ váº­y má»¥c tiÃªu chÃ­nh sáº½ nháº±m giáº£i quyáº¿t váº¥n Ä‘á» liÃªn quan Ä‘áº¿n viá»‡c khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng. Cá»¥ thá»ƒ hÆ¡n, Builder pattern sáº½ chia nhá» <strong><em>construction</em></strong> (khá»Ÿi táº¡o) cá»§a má»™t object phá»©c táº¡p. TÃ´i giá»¯ nguyÃªn tá»« construction khÃ´ng pháº£i Ä‘á»ƒ khoe tiáº¿ng Anh, mÃ  hÃ£y Ä‘á»ƒ Ã½ thÃªm chÃºt, construction cÃ³ khiáº¿n báº¡n liÃªn tÆ°á»Ÿng Ä‘áº¿n cÃ¡i gÃ¬ trong OOP khÃ´ng? ÄÃ³ chÃ­nh lÃ  constructor (hÃ m khá»Ÿi táº¡o), vÃ¬ láº½ Â Ä‘Ã³, phÆ°Æ¡ng phÃ¡p chia nhá» cá»§a Builder pattern sáº½ liÃªn quan Ä‘áº¿n constructor trong Class. Builder pattern Ä‘áº·t logic vÃ  cáº¥u hÃ¬nh máº·c Ä‘á»‹nh (default configuration) liÃªn quan Ä‘áº¿n viá»‡c khá»Ÿi táº¡o object tá»« class ra bÃªn ngoÃ i, vÃ o trong Builder class. Äáº·t ra ngoÃ i tháº¿ nÃ o, builder class vÃ  chi tiáº¿t ra sao? Xin má»i Ä‘á»c tiáº¿p.</p>

<h3 id="nÃ³-giáº£i-quyáº¿t-váº¥n-Ä‘á»-gÃ¬"><span style="color: #ff9900;">NÃ³ giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬?</span></h3>

<p>Äá»ƒ tráº£ lá»i cho cÃ¢u há»i á»Ÿ Ä‘á» má»¥c, hÃ£y cÃ¹ng tÃ´i xem xÃ©t bÃ i toÃ¡n sau:</p>

<p>Giáº£ sá»­ tÃ´i Ä‘ang táº¡o chÆ°Æ¡ng trÃ¬nh quáº£n lÃ½ cho quÃ¡n trÃ  sá»¯a, má»™t trong nhá»¯ng core function trong á»©ng dá»¥ng cá»§a tÃ´i Ä‘Ã³ lÃ  láº¥y yÃªu cáº§u Ä‘áº·t trÃ  sá»¯a tá»« khÃ¡ch hÃ ng vÃ  láº­p hÃ³a Ä‘Æ¡n thanh toÃ¡n cho há»:</p>

<p><img class="wp-image-1879 aligncenter" src="/wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5-1024x1024.jpg" alt="" width="300" height="300" srcset="/wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5-1024x1024.jpg 1024w, /wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5-150x150.jpg 150w, /wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5-300x300.jpg 300w, /wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5-768x768.jpg 768w, /wp-content/uploads/2019/05/BFV41761_DeliciousAsianDrinks_FBFINAL_v5.jpg 1080w" sizes="(max-width: 300px) 100vw, 300px" /></p>

<!-- <pre class="theme:xcode plain:false plain-toggle:false lang:swift decode:true"> -->

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">public</span> <span class="kd">class</span> <span class="kt">MilkTea</span> <span class="p">{</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// vá»‹ trÃ  sá»¯a: peach, origin, orange, kumquat,...
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// S-M-L
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="c1">// coconut, ....
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Æ°á»ng: 100% - 80% - 50 %
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Ã¡ 100% - 80% - 50 %
</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">],</span>
        <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span>
        <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="n">toppings</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="n">sugarPercent</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="n">icyPercent</span>
    <span class="p">}</span>

<span class="p">}</span></code></pre></figure>

<!-- </pre> -->

<p>CÃ³ nháº­n xÃ©t gÃ¬ vá» Ä‘oáº¡n code trÃªn:</p>

<ul>
  <li>Constructor (hÃ m init) khÃ¡ phá»©c táº¡p.</li>
  <li>Sáº½ luÃ´n cÃ³ thuá»™c tÃ­nh Ã­t cáº§n giÃ¡ trá»‹ máº·c Ä‘á»‹nh: vÃ­ dá»¥: Size â€“ M, 100% Ä‘Æ°á»ng, 100% Ä‘Ã¡,â€¦</li>
</ul>

<p>VÃ¬ cÃ³ nhá»¯ng thuá»™c tÃ­nh máº·c Ä‘á»‹nh Ã­t thay Ä‘á»•i, do Ä‘Ã³ khÃ´ng trÃ¡nh khá»i viá»‡c pháº£i láº·p:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">bigOrigin</span> <span class="o">=</span> <span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Origin"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="s">"L"</span><span class="p">,</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">smallOriginDecreaseSuger</span> <span class="o">=</span> <span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Origin"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="s">"M"</span><span class="p">,</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[],</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">bigOriginWithToppings</span> <span class="o">=</span> <span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Origin"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="s">"L"</span><span class="p">,</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="s">"coconut"</span><span class="p">],</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span></code></pre></figure>

<p>Duplicate tháº­t xáº¥u xÃ­, vÃ  khÃ´ng khi nÃ o lÃ  tá»‘t cáº£. Do Ä‘Ã³, ngÆ°á»i ta sá»­ dá»¥ng Builder Pattern.</p>

<h3 id="dÃ¹ng-nÃ³-tháº¿-nÃ o"><span style="color: #ff9900;">DÃ¹ng nÃ³ tháº¿ nÃ o?</span></h3>

<p>Váº«n theo format cÅ©, trÆ°á»›c khi Ä‘i vÃ o cá»¥ thá»ƒ, hÃ£y táº¡m dá»«ng Ä‘á»ƒ ngÃ³ qua Class Diagram cá»§a nÃ³ Ä‘Ã£:</p>

<p><img class="size-large wp-image-1874 aligncenter" src="/wp-content/uploads/2019/05/Untitled-Diagram-1024x320.png" alt="" width="768" height="240" srcset="/wp-content/uploads/2019/05/Untitled-Diagram-1024x320.png 1024w, /wp-content/uploads/2019/05/Untitled-Diagram-300x94.png 300w, /wp-content/uploads/2019/05/Untitled-Diagram-768x240.png 768w, /wp-content/uploads/2019/05/Untitled-Diagram.png 1314w" sizes="(max-width: 768px) 100vw, 768px" /></p>

<p>PhÃ¢n tÃ­ch Diagram trÃªn:</p>

<ol>
  <li><strong><span style="color: #993300;">Director</span></strong>: Ä‘áº¡i diá»‡n cho class / module cáº§n káº¿t quáº£ tá»« viá»‡c khá»Ÿi táº¡o MilkTea.</li>
  <li><strong><span style="color: #993300;">Builder</span></strong>: thiáº¿t káº¿ trá»«u tÆ°á»£ng cho cÃ¡c Builder, phá»¥c vá»¥ cho viá»‡c Director cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c mÃ  khÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n implementation cá»§a nÃ³ lÃ  gÃ¬. Má»¥c Ä‘Ã­ch typehint / swap / hoÃ¡n Ä‘á»•i implementation mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n Director.</li>
  <li><strong><span style="color: #993300;">MilkTeaBuilder</span></strong>: class implement InterfaceBuilder, cÃ³ nhiá»‡m vá»¥ khá»Ÿi táº¡o Object MilkTea, thÃ´ng qua hÃ m build().</li>
  <li><strong><span style="color: #993300;">MilkTea</span></strong>: object cáº§n Ä‘á»ƒ khá»Ÿi táº¡o.</li>
</ol>

<p>Äá»ƒ Ä‘Æ¡n giáº£n hÃ³a vÃ  vÃ¬ má»¥c Ä‘Ã­ch demo, nÃªn tÃ´i sáº½ loáº¡i bá» <code class="language-plaintext highlighter-rouge">interface Builder</code>.Â NhÆ° váº­y, Director thay vÃ¬ tÆ°Æ¡ng tÃ¡c trá»±c tiáº¿p vá»›i MilkTea, thÃ¬ giá» sáº½ tÆ°Æ¡ng tÃ¡c thÃ´ng qua <strong><span style="color: #993300;">MilkTeaBuilder</span></strong>:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">MilkTeaBuilder</span> <span class="p">{</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"origin"</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"M"</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">chooseTaste</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">chooseSize</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">addTopping</span><span class="p">(</span><span class="nv">topping</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="n">toppings</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">topping</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">chooseSugarPercent</span><span class="p">(</span><span class="nv">percent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="n">percent</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">chooseIcyPercent</span><span class="p">(</span><span class="nv">percent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="n">percent</span> <span class="p">}</span>

     <span class="kd">public</span> <span class="kd">func</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">MilkTea</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="n">taste</span><span class="p">,</span>
                        <span class="nv">size</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span> <span class="nv">toppings</span><span class="p">:</span> <span class="n">toppings</span><span class="p">,</span>
                        <span class="nv">sugarPercent</span><span class="p">:</span> <span class="n">sugarPercent</span><span class="p">,</span>
                        <span class="nv">icyPercent</span><span class="p">:</span> <span class="n">icyPercent</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">class</span> <span class="kt">Order</span> <span class="p">{</span>
<span class="k">let</span> <span class="nv">customerName</span><span class="p">:</span> <span class="kt">String</span>
<span class="k">let</span> <span class="nv">products</span><span class="p">:</span> <span class="p">[</span><span class="kt">MilkTea</span><span class="p">]</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">customerName</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">products</span><span class="p">:</span> <span class="p">[</span><span class="kt">MilkTea</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">customerName</span> <span class="o">=</span> <span class="n">customerName</span>
        <span class="k">self</span><span class="o">.</span><span class="n">products</span> <span class="o">=</span> <span class="n">products</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">let</span> <span class="nv">milkTeaBuilder</span> <span class="o">=</span> <span class="kt">MilkTeaBuilder</span><span class="p">()</span>

<span class="c1">// Customer 1
</span>
<span class="k">let</span> <span class="nv">customer1Name</span> <span class="o">=</span> <span class="s">"Shaw Vu"</span>
<span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">chooseTaste</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Peach"</span><span class="p">)</span>
<span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">chooseSize</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="s">"L"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">product1</span> <span class="o">=</span> <span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">build</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">order1</span> <span class="o">=</span> <span class="kt">Order</span><span class="p">(</span><span class="nv">customerName</span><span class="p">:</span> <span class="n">customer1Name</span><span class="p">,</span> <span class="nv">products</span><span class="p">:</span> <span class="p">[</span><span class="n">product1</span><span class="p">])</span>

<span class="c1">// Customer 2
</span>
<span class="k">let</span> <span class="nv">customer2Name</span> <span class="o">=</span> <span class="s">"Swifty VN"</span>
<span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">chooseTaste</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Origin"</span><span class="p">)</span>
<span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">chooseSize</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="s">"M"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">order2</span> <span class="o">=</span> <span class="kt">Order</span><span class="p">(</span><span class="nv">customerName</span><span class="p">:</span> <span class="n">customer2Name</span><span class="p">,</span> <span class="nv">products</span><span class="p">:</span> <span class="p">[</span><span class="n">milkTeaBuilder</span><span class="o">.</span><span class="nf">build</span><span class="p">()])</span></code></pre></figure>

<p>Order á»Ÿ Ä‘Ã¢y náº¯m vai trÃ² tÆ°Æ¡ng Ä‘Æ°Æ¡ng Director trong Diagram trÃªn. RÃµ rÃ ng, viá»‡c khá»Ÿi táº¡o MilkTea vá»›i thÃ´ng sá»‘ máº·c Ä‘á»‹nh Ä‘Ã£ Ä‘Æ¡n giáº£n, gá»n nháº¹ hÆ¡n ráº¥t nhiá»u pháº£i khÃ´ng? VÃ  Ä‘Ã³ chÃ­nh lÃ  cÃ¡ch viáº¿t Builder tuÃ¢n theo Builder Design Pattern, khÃ´ng cÃ³ gÃ¬ to tÃ¡t hay khÃ³ khÄƒn.</p>

<p>CÃ¡ch thá»±c hiá»‡n trÃªn báº£n cháº¥t lÃ  chia nhá» cÃ¡c properties cá»§a MilkTea ra thÃ nh cÃ¡c getter, setter Ä‘Æ°á»£c thiáº¿t láº­p trong class Builder, vÃ  sau Ä‘Ã³ tuáº§n tá»± láº§n lÆ°á»£t thá»±c hiá»‡n set giÃ¡ trá»‹ cho chÃºng (chooseTaste, Â chooseSize, addTopping,â€¦), rá»“i khá»Ÿi táº¡o object thÃ´ng qua hÃ m build().</p>

<p>Nghe tháº­t Ä‘Æ¡n giáº£n nhi? Äá»c tiáº¿p Ä‘i.</p>

<h3 id="cÃ³-gÃ¬-chÃº-Ã½"><span style="color: #ff9900;">CÃ³ gÃ¬ chÃº Ã½?</span></h3>

<p>ÄÆ°á»£c rá»“i, dá»«ng láº¡i táº¡i Ä‘Ã¢y, hÃ£y dÃ nh 5 phÃºt cuá»™c Ä‘á»i Ä‘á»ƒ Ä‘á»c vÃ  ngáº«m nghÄ© láº¡i bÃ i viáº¿t nÃ y tá»« Ä‘áº§u, báº¡n cÃ³ nháº­n ra Ä‘iá»u gÃ¬ khÃ´ng?</p>

<p>Náº¿u nhÆ° tÃ´i nháº­n Ä‘Æ°á»£c Pull Request kiá»ƒu nÃ y tá»« cÃ¡c thÃ nh viÃªn trong team, tÃ´i sáº½ cháº³ng ngáº§n ngáº¡i mÃ  close vÃ  báº¯t ngÆ°á»i Ä‘Ã³ pháº£i xÃ³a Ä‘i viáº¿t láº¡i ngay láº­p tá»©c.</p>

<p>Thá»±c táº¿ mÃ  nÃ³i, chá»§ Ä‘á» Builder Pattern nhan nháº£n trÃªn máº¡ng, báº¡n cÃ³ thá»ƒ search 1 lÃºc, sáº½ tháº¥y cáº£ tÃ¡ bÃ i viáº¿t vá»›i lá»‘i mÃ²n nhÆ° tÃ´i vá»«a lÃ m. LÃ½ do tÃ´i yÃªu cáº§u báº¡n dÃ nh 5 phÃºt Ä‘á»c láº¡i bÃ i viáº¿t lÃ  vÃ¬ tÃ´i muá»‘n báº¡n cÃ³ thá»ƒ pháº£n biá»‡n Ä‘Æ°á»£c cÃ¡ch xÃ¢y dá»±ng Builder Pattern cá»§a tÃ´i. (Trong thá»i Ä‘áº¡i thÃ´ng tin bÃ¹ng ná»• nÃ y, thiáº¿t nghÄ© tÆ° duy pháº£n biá»‡n vÃ  phÃ¢n tÃ­ch thÃ´ng tin lÃ  cá»±c ká»³ quan trá»ng, vÃ¬ váº­y, tÃ´i hi vá»ng báº¡n cÅ©ng nÃªn dá»«ng láº¡i vÃ  phÃ¢n tÃ­ch ná»™i dung cÃ¡c thÃ´ng tin mÃ  mÃ¬nh kiáº¿m Ä‘Æ°á»£c)</p>

<p>Okay, Ä‘i hÆ¡i xa rá»“i Ä‘Ã³, cÃ¡ch lÃ m trÃªn thay vÃ¬ Ä‘Æ°á»£c khuyáº¿n khÃ­ch, trÃ¡i láº¡i trá»Ÿ thÃ nh <strong><span style="color: #ff0000;">Anti-pattern</span></strong>, tá»©c lÃ  nÃªn trÃ¡nh lÃ m theo. LÃ½ giáº£i cho Ä‘iá»u nÃ y, vÃ¢ng, xin má»i báº¡n Ä‘á»c tiáº¿p.</p>

<p>(Builder Pattern xÃ¢y dá»±ng theo cÃ¡ch trÃªn thá»±c ra thÆ°á»ng dÃ¹ng Ä‘á»ƒ trÃ¡nh váº¥n Ä‘á» <span style="color: #993300;"><strong><em>Telescoping Initializer / Telescoping Constructor</em></strong><span style="color: #000000;">)</span></span></p>

<p><span style="color: #339966;"><em><strong>Telescoping Initializer</strong></em></span></p>

<p>Telescoping Initializer lÃ  trÆ°á»ng há»£p khi má»™t Class cÃ³ quÃ¡ nhiá»u initializer / constructor theo Ä‘á»‹nh dáº¡ng kiá»ƒu nhÆ° sau:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">public</span> <span class="kd">class</span> <span class="kt">MilkTea</span> <span class="p">{</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// vá»‹ trÃ  sá»¯a: peach, origin, orange, kumquat,...
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// S-M-L
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="c1">// coconut, ....
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Æ°á»ng: 100% - 80% - 50 %
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Ã¡ 100% - 80% - 50 %
</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">],</span>
        <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span>
        <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="n">toppings</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="n">sugarPercent</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="n">icyPercent</span>
    <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="s">"M"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="s">"origin"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">}</span>

<span class="o">....</span>
<span class="p">}</span></code></pre></figure>

<p>NÃªn nhá»›, Builder Pattern Ä‘Æ°á»£c giá»›i thiá»‡u láº§n Ä‘áº§u tá»« cuá»‘n sÃ¡ch cá»§a Gang of Four, ngÃ´n ngá»¯ há» sá»­ dá»¥ng lÃ  C++, vÃ  láº¡i xuáº¥t báº£n tá»« 30-40 nÄƒm trÆ°á»›c. Swift lÃ  ngÃ´n ngá»¯ hiá»‡n Ä‘áº¡i, váº¥n Ä‘á» Telescoping Initializer nÃ y khÃ´ng cÃ²n lÃ  trá»Ÿ ngáº¡i ná»¯a, tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡ch xÃ¢y dá»±ng Builder Pattern mÃ  tÃ´i Ä‘Ã£ cáº¥t cÃ´ng trÃ¬nh bÃ y lÃ  vÃ´ dá»¥ng.</p>

<p><span style="color: #339966;"><strong><em>Anti-pattern</em></strong></span></p>

<p>Telescoping Initializer khÃ´ng cÃ²n lÃ  váº¥n Ä‘á» -&gt; Builder Pattern nhÆ° trÃªn vÃ´ dá»¥ng -&gt; khÃ´ng cáº§n thiáº¿t -&gt; anti-pattern. Swift cung cáº¥p feature <span style="color: #ff0000;"><strong><code>default parameters</code></strong></span>, vÃ  nhá» vÃ o feature nÃ y, chÃºng ta hoÃ n toÃ n cÃ³ thá»ƒ loáº¡i bá» Builder:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">public</span> <span class="kd">class</span> <span class="kt">MilkTea</span> <span class="p">{</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// vá»‹ trÃ  sá»¯a: peach, origin, orange, kumquat,...
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span> <span class="c1">// S-M-L
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="c1">// coconut, ....
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Æ°á»ng: 100% - 80% - 50 %
</span>
<span class="kd">private</span> <span class="k">let</span> <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="c1">// pháº§n trÄƒm Ä‘Ã¡ 100% - 80% - 50 %
</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"origin"</span><span class="p">,</span>
        <span class="nv">size</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"M"</span><span class="p">,</span>
        <span class="nv">toppings</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="nv">sugarPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="nv">icyPercent</span><span class="p">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">taste</span> <span class="o">=</span> <span class="n">taste</span>
        <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">self</span><span class="o">.</span><span class="n">toppings</span> <span class="o">=</span> <span class="n">toppings</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sugarPercent</span> <span class="o">=</span> <span class="n">sugarPercent</span>
        <span class="k">self</span><span class="o">.</span><span class="n">icyPercent</span> <span class="o">=</span> <span class="n">icyPercent</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"peach"</span><span class="p">)</span>
<span class="kt">MilkTea</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="s">"L"</span><span class="p">)</span>
<span class="kt">MilkTea</span><span class="p">(</span><span class="nv">taste</span><span class="p">:</span> <span class="s">"Kumquat"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="s">"S"</span><span class="p">,</span> <span class="nv">toppings</span><span class="p">:</span> <span class="p">[])</span></code></pre></figure>

<p><span style="color: #339966;"><em><strong>Builder Pattern trong Swift lÃ  vÃ´ dá»¥ng?</strong></em></span></p>

<p>CÃ¢u tráº£ lá»i lÃ  khÃ´ng. TÃ´i muá»‘n trÃ¬nh bÃ y kÄ© vÃ¬ báº£n thÃ¢n tÃ´i cÅ©ng bá»‹ ngÃ¡o ngÆ¡ khi tÃ¬m hiá»ƒu vá» Builder trong Swift, vÃ¬ nhÆ° trÃªn, cÃ¡c tÃ i liá»‡u trÃªn máº¡ng thÆ°á»ng trÃ¹ng láº·p vÃ  hÆ°á»›ng ngÆ°á»i Ä‘á»c vÃ o váº¥n Ä‘á» Telescoping â€“ váº¥n Ä‘á» thÆ°á»ng gáº·p á»Ÿ cÃ¡c ngÃ´n ngá»¯ cá»• Ä‘iá»ƒn.</p>

<p>CÃ¡i hay cá»§a Builder á»Ÿ náº±m á»Ÿ viá»‡c giáº£m thiá»ƒu sá»± phá»©c táº¡p khi khÆ¡i táº¡o Object, thÃ´ng qua hÃ mÂ <span style="color: #993300;"><code>build() -&gt; Type</code></span>Â â€“ báº£n cháº¥t lÃ  viá»‡c Ä‘Ã³ng gÃ³i quÃ¡ trÃ¬nh khá»Ÿi táº¡o nÃ y láº¡i, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c logic, lÃ m abcxyz gÃ¬ Ä‘Ã³, rá»“i má»›i tráº£ vá» Object sau cÃ¹ng. Äáº·c Ä‘iá»ƒm quan trá»ng nÃ y lÃ  lÃ½ do chÃ­nh khiáº¿n Builder Pattern váº«n Ä‘Ã£ vÃ  Ä‘ang Ä‘Æ°á»£c á»©ng dá»¥ng trong Swift iOS.</p>

<h3 id="á»©ng-dá»¥ng-trong-ios"><span style="color: #ff9900;">á»¨ng dá»¥ng trong iOS?</span></h3>

<p>Challenge 1 chÃºt, cÃ³ vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃ o mÃ  constructor cá»§a class phá»©c táº¡p khÃ´ng?</p>

<p>ÄÃ³ chÃ­nh lÃ  trÆ°á»ng há»£p Constructor Dependency Injection:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">apiService</span><span class="p">:</span> <span class="kt">IAPIService</span><span class="p">,</span>
         <span class="nv">databaseService</span><span class="p">:</span> <span class="kt">IDBService</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ViewControllerBuilder</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">ViewController</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">apiService</span> <span class="o">=</span> <span class="kt">APIService</span><span class="p">(</span><span class="n">alamofire</span><span class="p">,</span> <span class="n">environment</span><span class="p">)</span>
        <span class="c1">// do stuff
</span>
        <span class="k">let</span> <span class="nv">dbService</span> <span class="o">=</span> <span class="kt">DBService</span><span class="p">()</span>

        <span class="k">return</span> <span class="kt">ViewController</span><span class="p">(</span>
            <span class="nv">apiService</span><span class="p">:</span> <span class="n">apiService</span><span class="p">,</span>
            <span class="nv">databaseService</span><span class="p">:</span> <span class="n">dbService</span>
        <span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span></code></pre></figure>

<p>CÃ³ ráº¥t nhiá»u dependencies phá»©c táº¡p, theo kiá»ƒu khá»Ÿi táº¡o dá»±a theo cÃ¡c dependency khÃ¡c, Ä‘á»“ng nghÄ©a vá»›i viá»‡c khÃ´ng thá»ƒ sá»­ dá»¥ng default parameters. HÆ¡n ná»¯a, vÃ¬ nÃ³ phá»©c táº¡p, cho nÃªn chÃºng ta nghÄ© Ä‘áº¿n viá»‡c tÃ¡ch riÃªng nÃ³ ra Ä‘á»ƒ xá»­ lÃ½, vÃ  Builder lÃ  má»™t trong nhá»¯ng cÃ¡ch tiáº¿p cáº­n Ä‘Ã¡ng xem xÃ©t.</p>

<p>TÆ° tÆ°á»Ÿng Builder Ä‘Æ°á»£c Ã¡p dá»¥ng trong module Router / Navigator / Coordinator trong cÃ¡c dá»± Ã¡n iOS, vÃ­ dá»¥: Router trong kiáº¿n trÃºc V-I-P-E-R, hoáº·c RIBs (hÃ ng cá»§a UBer), Alamofire / Moya,â€¦.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kt">Source</span><span class="p">:</span> <span class="nv">https</span><span class="p">:</span><span class="c1">//gist.github.com/jazzbpn/afd9f178fe4d8a212d83750e1b4a5389#file-viper-noticerouter-swift // Router in VIPER architectur
</span>

<span class="kd">class</span> <span class="kt">NoticeRouter</span><span class="p">:</span><span class="kt">PresenterToRouterProtocol</span> <span class="p">{</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createModule</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">NoticeViewController</span> <span class="p">{</span>

        <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">mainstoryboard</span><span class="o">.</span><span class="nf">instantiateViewController</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"MyViewController"</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">NoticeViewController</span>

        <span class="k">let</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">ViewToPresenterProtocol</span> <span class="o">&amp;</span> <span class="kt">InteractorToPresenterProtocol</span> <span class="o">=</span> <span class="kt">NoticePresenter</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">interactor</span><span class="p">:</span> <span class="kt">PresenterToInteractorProtocol</span> <span class="o">=</span> <span class="kt">NoticeInteractor</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">router</span><span class="p">:</span><span class="kt">PresenterToRouterProtocol</span> <span class="o">=</span> <span class="kt">NoticeRouter</span><span class="p">()</span>

        <span class="n">view</span><span class="o">.</span><span class="n">presentor</span> <span class="o">=</span> <span class="n">presenter</span>
        <span class="n">presenter</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
        <span class="n">presenter</span><span class="o">.</span><span class="n">router</span> <span class="o">=</span> <span class="n">router</span>
        <span class="n">presenter</span><span class="o">.</span><span class="n">interactor</span> <span class="o">=</span> <span class="n">interactor</span>
        <span class="n">interactor</span><span class="o">.</span><span class="n">presenter</span> <span class="o">=</span> <span class="n">presenter</span>

        <span class="k">return</span> <span class="n">view</span>
    <span class="p">}</span>

    <span class="kd">static</span> <span class="k">var</span> <span class="nv">mainstoryboard</span><span class="p">:</span> <span class="kt">UIStoryboard</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">UIStoryboard</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span><span class="s">"Main"</span><span class="p">,</span><span class="nv">bundle</span><span class="p">:</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">pushToMovieScreen</span><span class="p">(</span><span class="n">navigationConroller</span> <span class="nv">navigationController</span><span class="p">:</span><span class="kt">UINavigationController</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">let</span> <span class="nv">movieModue</span> <span class="o">=</span> <span class="kt">MovieRouter</span><span class="o">.</span><span class="nf">createMovieModule</span><span class="p">()</span>
        <span class="n">navigationController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">movieModue</span><span class="p">,</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

    <span class="p">}</span>

<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// Uber/RIBs - Router example
</span>
<span class="kd">protocol</span> <span class="kt">RootBuildable</span><span class="p">:</span> <span class="kt">Buildable</span> <span class="p">{</span>
<span class="kd">func</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">LaunchRouting</span>
<span class="p">}</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RootBuilder</span><span class="p">:</span> <span class="kt">Builder</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">RootDependency</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;,</span> <span class="kt">RootBuildable</span> <span class="p">{</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">dependency</span><span class="p">:</span> <span class="kt">RootDependency</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">dependency</span><span class="p">:</span> <span class="n">dependency</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">LaunchRouting</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">RootViewController</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">component</span> <span class="o">=</span> <span class="kt">RootComponent</span><span class="p">(</span><span class="nv">dependency</span><span class="p">:</span> <span class="n">dependency</span><span class="p">,</span> <span class="nv">rootViewController</span><span class="p">:</span> <span class="n">viewController</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">interactor</span> <span class="o">=</span> <span class="kt">RootInteractor</span><span class="p">(</span><span class="nv">presenter</span><span class="p">:</span> <span class="n">viewController</span><span class="p">)</span>

        <span class="k">let</span> <span class="nv">loggedOutBuilder</span> <span class="o">=</span> <span class="kt">LoggedOutBuilder</span><span class="p">(</span><span class="nv">dependency</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">loggedInBuilder</span> <span class="o">=</span> <span class="kt">LoggedInBuilder</span><span class="p">(</span><span class="nv">dependency</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">RootRouter</span><span class="p">(</span><span class="nv">interactor</span><span class="p">:</span> <span class="n">interactor</span><span class="p">,</span>
                          <span class="nv">viewController</span><span class="p">:</span> <span class="n">viewController</span><span class="p">,</span>
                          <span class="nv">loggedOutBuilder</span><span class="p">:</span> <span class="n">loggedOutBuilder</span><span class="p">,</span>
                          <span class="nv">loggedInBuilder</span><span class="p">:</span> <span class="n">loggedInBuilder</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span></code></pre></figure>

<h3 id="káº¿t-luáº­n"><span style="color: #ff9900;">Káº¿t luáº­n</span></h3>

<p>Builder Design Pattern tuy lÃ  pattern Ä‘Æ¡n giáº£n vÃ  dá»… thá»±c hiá»‡n, nhÆ°ng trong Swift, nÃ³ váº«n hoÃ n toÃ n cÃ³ thá»ƒ lÃ  anti-pattern nhÆ° tÃ´i Ä‘Ã£ phÃ¢n tÃ­ch á»Ÿ trÃªn. TÃ´i váº«n luÃ´n khuyáº¿n khÃ­ch báº¡n Ä‘á»c tiáº¿p cáº­n Ä‘Æ°á»£c vá»›i tÆ° duy vÃ  Ã½ tÆ°á»Ÿng cá»§a Pattern hÆ¡n lÃ  cÃ¡ch implement cá»§a nÃ³.Â  KhÃ´ng nÃªn Ã¡p dá»¥ng má»™t pattern nÃ o Ä‘Ã³ chá»‰ vÃ¬ cÃ³ ngÆ°á»i báº£o ráº±ng báº¡n nÃªn lÃ m váº­y.</p>

<p>TÃ³m láº¡i, qua bÃ i viáº¿t nÃ y, tÃ´i cáº§n báº¡n pháº£i náº¯m Ä‘Æ°á»£c:</p>

<ul>
  <li>Builder Pattern lÃ  gÃ¬? TÆ° tÆ°á»Ÿng cá»§a nÃ³ lÃ  gÃ¬?</li>
  <li>Thá»±c hiá»‡n Builder Pattern nhÆ° tháº¿ nÃ o?</li>
  <li>Telescoping initializer vÃ  trÆ°á»ng há»£p Builder pattern trá»Ÿ thÃ nh anti-pattern</li>
  <li>NgÆ°á»i ta Ä‘ang sá»­ dá»¥ng Builder Pattern nhÆ° nÃ o?</li>
</ul>

<p>CÃ¡m Æ¡n cÃ¡c báº¡n Ä‘Ã£ dÃ nh thá»i gian Ä‘á»c Ä‘áº¿n táº­n dÃ²ng nÃ y.</p>

<p>Tham kháº£o:</p>

<ul>
  <li>Prodesign Pattern in Swift</li>
  <li>Design Pattern by Tutorial</li>
  <li>https://gist.github.com/jazzbpn/afd9f178fe4d8a212d83750e1b4a5389#file-viper-noticerouter-swift</li>
  <li>https://github.com/uber/RIBs/wiki/iOS-Tutorial-2</li>
  <li>https://github.com/Alamofire/Alamofire/blob/master/Documentation/AdvancedUsage.md</li>
</ul>

<script id="dsq-count-scr" src="//https-vigorous-sinoussi-c377b6-netlify-com.disqus.com/count.js" async=""></script>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-vigorous-sinoussi-c377b6-netlify-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
:ET